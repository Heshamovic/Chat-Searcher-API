# CHAT SEARCH REST API
This is rails v5 API Used to search in applications' chats' messages.

All you have to do to install and run the API is just to the following docker command.

The API will run on port 3001. There you can send all your requests.

## Install using Docker

    docker-compose up

# REST API

The system allows creating new applications where each application will have a token (generated by the system) and a name (provided by the client). The token is the identifier that devices use to send chats to that application. The token is returned in the application creation request.

Each application can have many chats. Each chat has a number. Numbering of chats in each application starts from 1. No chats in the same application may have the same number. The number of the chat is returned in the chat creation request.

A chat contains messages and messages have numbers that start from 1 for each chat. The number of the message is returned in the message creation request.

The application is identified by its token and the chat by
its number along with the application token.

You can search through messages of a specific chat. Searching is done by partially matching messagesâ€™ bodies.

Each application has a field called chats_count that contains the number of chats for this application. Similarly, the chats has a field called messages_count that contains the number of messages in this chat.

# API Requests

## Search in a specific chat messages

### Request

`GET /chat_search/`

    GET: http://localhost:3001/api/v1/chat_search
    json: {
		"app_token": "ee45002f91762826506285b98278fbc8",
		"chat_number": 1,
		"search_text": "you"
	}

### Response

    Status: 200 ok
    Content-Type: application/json
    content: {
		"status": "SUCCESS",
		"msgs_found": {
			"5": "fine thank you",
			"6": "fine thank you",
			"4": "hey How are you?"
		}
	}

## Create a New Application

### Request

`POST /Applications/`

    POST: http://localhost:3001/api/v1/applications
    json: {
    	"name": "Application 1"
    }

### Response

    Status: 201 Created
    Content-Type: application/json
    content: {
		"status": "SUCCESS",
		"message": "Application Created Successfully",
		"app_token": "eb9e05a7f66ad2ff3cdfda0a51aa139d"
	}

## Get a Specific Application

### Request

`GET /Applications/token`

    GET: http://localhost:3001/api/v1/applications/{app_token}

### Response

    Status: 200 ok
    Content-Type: application/json
    content: {
		"status": "SUCCESS",
		"application": {
			"name": "Test 1",
			"chats_count": 0
		}
	}

## Get a non-existent Application

### Request

`GET /Applications/token`

    GET: http://localhost:3001/api/v1/applications/{non-existant_app_token}

### Response

    Status: 404 Not Found
    Content-Type: application/json
    content: {
		"status": "ERROR",
		"error": "Application doesn't exist"
	}

## Change application's name

### Request

`PATCH /Applications/token`

    PATCH: http://localhost:3001/api/v1/applications/{app_token}
    json: {
		"name": "Test 1 updated app successfully" 
	}

### Response

    Status: 200 ok
    Content-Type: application/json
    content: {
		"status": "SUCCESS",
		"message": "Application Updated Successfully"
	}

## Change non-existant application's name

### Request

`PATCH /Applications/token`

    PATCH: http://localhost:3001/api/v1/applications/{wrong_app_token}
    json: {
		"name": "Test 1 updated app successfully" 
	}

### Response

    Status: 404 Not Found
    Content-Type: application/json
    content: {
		"status": "ERROR",
		"message": "Application doesn't exist"
	}

## Create a Chat

### Request

`POST /chats/`

    POST: http://localhost:3001/api/v1/chats
    json: {
    	"app_token": "eb9e05a7f66ad2ff3cdfda0a51aa139d"
    }

### Response

    Status: 201 Created
    Content-Type: application/json
    content: {
		"status": "SUCCESS",
		"message": "Chat Created Successfully",
		"chat_number": 1
	}

## Get a Specific Chat

### Request

`GET /chats/chat_number`

    GET: http://localhost:3001/api/v1/chats/{chat_number}
    json: {
    	"app_token": "eb9e05a7f66ad2ff3cdfda0a51aa139d"
    }

### Response

    Status: 200 ok
    Content-Type: application/json
    content: {
		"status": "SUCCESS",
		"chat": {
			"number": 1,
			"messages_count": 5
		}
	}

## Get a non-existent chat

### Request

`GET /chats/chat_number`

    GET: http://localhost:3001/api/v1/chats/{non-existant_chat_number}
    json: {
    	"app_token": "eb9e05a7f66ad2ff3cdfda0a51aa139d"
    }

### Response if provided app token is wrong

    Status: 404 Not Found
    Content-Type: application/json
    content: {
		"status": "ERROR",
		"error": "Application doesn't exist"
	}

### Response if provided chat number is wrong

    Status: 404 Not Found
    Content-Type: application/json
    content: {
		"status": "ERROR",
		"error": "Chat doesn't exist"
	}

## Create a New Message

### Request

`POST /messages/`

    POST: http://localhost:3001/api/v1/messages
    json: {
		"app_token": "ee45002f91762826506285b98278fbc8",
		"chat_number": 1,
		"body": "fine thank you"
	}

### Response

    Status: 201 Created
    Content-Type: application/json
    content: {
		"status": "SUCCESS",
		"message": "Message Created Successfully",
		"message_number": 2
	}

## Get a Specific Message

### Request

`GET /messages/message_number`

    GET: http://localhost:3001/api/v1/messages/{message_number}
    json: {
		"app_token": "ee45002f91762826506285b98278fbc8",
		"chat_number": 1
    }

### Response

    Status: 200 ok
    Content-Type: application/json
    content: {
		"status": "SUCCESS",
		"message": "Message 1 updated"
	}

## Get a non-existent Message

### Request

`GET /messages/message_number`

    GET: http://localhost:3001/api/v1/messages/{non-existent_message_number}
    json: {
		"app_token": "ee45002f91762826506285b98278fbc8",
		"chat_number": 1
    }

### Response if provided app token is wrong

    Status: 404 Not Found
    Content-Type: application/json
    content: {
		"status": "ERROR",
		"error": "Application doesn't exist"
	}

### Response if provided chat number is wrong

    Status: 404 Not Found
    Content-Type: application/json
    content: {
		"status": "ERROR",
		"error": "Chat doesn't exist"
	}


### Response if provided message number is wrong

    Status: 404 Not Found
    Content-Type: application/json
    content: {
		"status": "ERROR",
		"error": "Message doesn't exist"
	}

## Change Message's body

### Request

`PATCH /messages/message_number`

    PATCH: http://localhost:3001/api/v1/chats/{message_number}
    json: {
		"app_token": "ee45002f91762826506285b98278fbc8",
		"chat_number": 1,
		"body": "Message 1 updated"
	}

### If any of the json parameters isn't send, you will get 422 Unprocessable Entity error with the missing parameter

